
<section id="person-profile" *ngIf="person">
    <div>
        <div class="row">
            <div class="col-12">
                <div class="card" style="padding:1%">
                    <div class="row">
                        <div class="col-2">
                            <div class="align-self-center halfway-fab text-center">
                                <a class="profile-image">                                    
                                    <img src="assets/img/portrait/avatars/avatar-08.png" 
                                    class="rounded-circle img-border gradient-summer width-100" 
                                    alt="Card image"
                                    *ngIf="!person.avatar_img || person.avatar_img.length <= 0"/>
                                
                                    <img alt="{{ person.name }}"
                                        class="rounded-circle img-border " 
                                        src="https://myvtmiim.blob.core.windows.net/avatars/{{ person.avatar_img }}" 											
                                        style="min-width:50px;width:100%;" 
                                        *ngIf="person.avatar_img && person.avatar_img.length > 0" />	
                                </a>
                            </div>
                        </div>
                        <div class="col-9">
                            <div class="row">
                                <div class="col-12">
                                    <h3 style="font-weight:bold">{{ person.name }}</h3>
                                </div>                                
                            </div>
                            <div class="row" *ngIf="person.is_disciple && (person.kf_name_ideograms || person.kf_name_ideograms )">
                                <div class="col-4">
                                    <div>                                        
                                        <h4>
                                            {{ person.kf_name }} - {{ person.kf_name_ideograms }}
                                        </h4>                                                                                                                        
                                    </div>                                
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-2" *ngIf="person.is_active_member || person.is_disciple">
                                    <label for="admission_date">Admissão</label> 
                                    <span id="admission_date"
                                        [ngStyle]="{ 'color': !person.admission_date ? 'red' : null }">
                                        {{ person.admission_date || 'Não definida'  }}                                    
                                    </span>
                                </div> 
                                <div class="col-2" *ngIf="person.is_active_member || person.is_disciple">
                                    <label for="admission_date">Aniversário</label> 
                                    <span id="admission_date" 
                                        [ngStyle]="{ 'color': !person.birth_date ? 'red' : null }">
                                        {{ person.birth_date || 'Não definido'  }}                                    
                                    </span>
                                </div>
                                <div class="col-2" *ngIf="person.is_disciple">
                                    <label for="baaisi_date">Baai Si</label> 
                                    <span id="baaisi_date" 
                                        [ngStyle]="{ 'color': !person.baaisi_date ? 'red' : null }">
                                        {{ person.baaisi_date || 'Não definido'  }}                                    
                                    </span>
                                </div>                                
                            </div>
                        </div>
                        <div class="col-1">
                            <button type="button"                                 
                                [routerLink]="['/person/edit', id]"
                                class="btn btn-primary btn-raised btn-xl icon-edit"
                                title="Alterar pessoa"                                                                    
                                >					
                                Alterar											
                            </button>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-10 offset-2">
                            <b>Papéis:</b>
                            <ng-template ngFor let-person_role [ngForOf]="person.roles" let-pri=index let-m=first>                                
                                <span *ngIf="pri > 0">,</span>
                                <a (click)="begin_remove_role(person_role)"
                                [ngStyle]="{'font-weight': person_role.removing ? 'bold' : null, 
                                            'border-bottom': person_role.removing ? '1px dotted #000' : null }">
                                    {{ person_role.role }}
                                </a>
                                <button type="button" 
                                    (click)="remove_role(person_role.role_id)"
                                    class="btn btn-danger btn-raised btn-sm icon-trash"
                                    title="Confirmar Remoção de Papel"                                    
                                    *ngIf="person_role.removing"
                                    >																
                                </button>
                                <button type="button" 
                                    (click)="cancel_remove_role(person_role)"
                                    class="btn btn-gray btn-raised btn-sm icon-action-undo"
                                    title="Cancelar Remoção"
                                    style="margin-left:5px"
                                    *ngIf="person_role.removing"
                                    >																
                                </button>
                            </ng-template>																
                            
                            <span *ngIf="!person.roles || person.roles.length == 0">Nenhum papel definido</span>
                            <button type="button" 
                                (click)="open(new_role_modal)"
                                class="btn btn-secundary btn-raised btn-sm ft-plus"
                                title="Adicionar Papel"
                                style="margin-left:10px"
                                >																
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>        
</section>


<ng-template #new_role_modal let-c="close" let-d="dismiss">
    <div class="modal-header">
        <h5 class="modal-title" style="font-weight: bold">
            Adicionar Papel
        </h5>
        <button type="button" class="close" aria-label="Close" (click)="d('Cross click')">
        <span aria-hidden="true">&times;</span>
        </button>
    </div>
    <div class="modal-body">		
        <select id="branch" 
            [(ngModel)]="new_role"                         
            >						
            <option *ngFor="let r of person.possible_roles" [value]="r.id">{{r.name}}</option>
        </select>
    </div>
    <div class="modal-footer">
        <button type="button" class="btn btn-primary btn-raised" 
            (click)="add_role();d('add role!');"
            *ngIf="new_role">
            Adicionar
        </button>        
        <button type="button" class="btn btn-grey btn-raised" 			            
            (click)="d('Cancelled')">
            Cancelar
        </button>        
    </div>
</ng-template>